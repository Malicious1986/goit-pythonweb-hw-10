# goit-pythonweb-hw-08

Simple FastAPI project (contacts API).

## Requirements

- Python 3.12+
- Docker (for running PostgreSQL locally)

Dependencies are defined in `pyproject.toml` (Poetry is the recommended installer).

## Install

Recommended (Poetry):

```zsh
# install Poetry if you don't have it
curl -sSL https://install.python-poetry.org | python3 -

# install dependencies
poetry install
```

Or using a virtual environment and pip:

```zsh
python3 -m venv .venv
source .venv/bin/activate
pip install --upgrade pip
pip install "fastapi[standard]" uvicorn[standard] sqlalchemy asyncpg alembic python-dotenv
```

## Configuration (.env)

The application reads the DB URL from the `DB_URL` environment variable. You can provide it via a `.env` file at the project root (the project uses `python-dotenv` when available). Example `.env`:

```env
DB_URL=postgresql+asyncpg://postgres:567234@localhost:5432/contacts
```

If `DB_URL` is not provided, the app falls back to a reasonable default defined in `src/conf/config.py`.

## Start Postgres (Docker)

Start a local PostgreSQL container:

```zsh
docker run --name db-postgres -p 5432:5432 -e POSTGRES_PASSWORD=567234 -d postgres
```

This will:

- run a Postgres container named `db-postgres`
- expose port `5432` so the app can reach `localhost:5432`
- set the `postgres` user's password to `567234`

If you need the `contacts` database, create it with:

```zsh
docker exec -it db-postgres psql -U postgres
# inside psql:
CREATE DATABASE contacts;
\q
```

## Run database migrations (Alembic)

Once the DB is running and `DB_URL` points to it, run migrations to create the schema:

```zsh
# generate a revision (if you have model changes and want autogenerate)
alembic revision --autogenerate -m 'Init'

# apply migrations
alembic upgrade head
```

Notes:

- Review autogenerated migration scripts in `migrations/versions/` before applying them.
- Ensure `DB_URL` matches your running database.

## Run the app (development)

Using Poetry (recommended):

```zsh
poetry run python main.py
```

Or using Uvicorn directly:

```zsh
uvicorn main:app --reload --host 127.0.0.1 --port 8000
```

There is also a convenience `fastapi dev` command if you have the FastAPI CLI installed in your environment.

## API docs

When the app is running (default host `127.0.0.1:8000`):

- Swagger UI: http://127.0.0.1:8000/docs
- ReDoc: http://127.0.0.1:8000/redoc

API routes are mounted under the `/api` prefix, so endpoints will appear with paths starting with `/api`.

## Quick smoke test

1. Start the Postgres container.
2. Create the `contacts` DB (if necessary) and run migrations.
3. Start the app.
4. Open `http://127.0.0.1:8000/docs` in a browser and exercise an endpoint.

## Notes

- The project is configured with `pyproject.toml` and Poetry; if you prefer pip, consider exporting `requirements.txt` with `poetry export` for reproducible installs.
- Alembic migrations are located in the `migrations/` folder.
